In early 2020, a contagious disease called COVID-19 started to spread in Europe, including Denmark. With new infections showing up faster and faster, governments started to implement different measures to limit the spread of the contagious disease, including lockdowns, travel restrictions, and social distancing, measures not previously seen in peacetime since the Spanish flu in 1918. This was the background for the work that we did in 2020 which became the basis for Paper III, see \autoref{chapter:covid19-agent-based-model}. This paper deals with the development of a new agent based model for COVID-19 in Denmark in collaboration with Statens Serum Institut (SSI), the Danish Center for Disease Control.

Historically, most mathematical models of infectious diseases were variations of the SIR model, which describe the evolution of a pandemic by approximating all individuals as one population \autocite{kermackContributionMathematicalTheory1927}.
As one of the simplest compartmental models, the susceptible-infectious-recovered (SIR) model is based on a system of three non-linear differential equations that describe the transition between each state, or compartment, of the model \autocite{krogerAnalyticalSolutionSIRmodel2020}.
Initially the entire population is susceptible. At $t=0$ an outbreak happens where some number of random agents are infected and become infectious, allowing the disease to spread. After having been infectious, the individuals recover and become immune to the disease and stop being infectious. Several variations of the SIR model exist, including the SIS model, where the recovered individuals become susceptible again \autocite{hethcoteThreeBasicEpidemiological1989}. Another variation is the SEIR model, which includes an exposed state, where individuals are infected but not yet infectious, which is the basis for the model used in Paper III.

SIR-like models suffer from several shortcomings, including the assumptions that the population is homogeneous, and that agents are equally infectious throughout there infectious period. In reality, neither the population nor the transmission rates are homogenous. While multistage SEIR and multicompartment models can help mitigate some of the issues none of these can handle the geographical interactions between agents, which is why we chose to develop an agent based model (ABM) \autocite{wuMultistageTimeDelayControl2022,tangReviewMultiCompartmentInfectious2020}. Agent based models simulate individual agents in a population in a way that allows for complex interactions patterns, e.g. based on geographical features such as agent density \autocite{wilenskyIntroductionAgentBasedModeling2015}.

In particular, we implemented an event-based, stochastic, spatial ABM using the Gillespie algorithm, a stochastic simulation algorithm \autocite{gillespieExactStochasticSimulation1977}. The model is JIT compiled with Numba \autocite{lamNumbaLLVMbasedPython2015} to speed up the simulation, allowing the simulation of the Danish population of 5.8 million people in a couple of hours instead of days. The model allows for the individual tuning of the three main effects; A) heterogeneities in the infection strength\sidenote{allowing \emph{super-shedders}}, B) heterogeneities in the number of connections\sidenote{allowing \emph{super-connecters}}, C) and the spatial clustering of the agents. In the absence of any of these effects, we find that the ABM's predictions matches the SEIR model's predictions within $\pm 5 \%$. Once we allowed for spatial clustering, we found that the epidemic developed faster and with a higher infection peak compared to the SEIR model, but that the total number of infected in the end of the epidemic was lower.

In real-life scenarios, one does not have the opportunity to let the epidemic run loose and afterwards evaluate the strength of the epidemic; the goal is to predict the intensity in the very beginning of the epidemic and implement lockdown-related measured based on this estimate. In the second part of Paper III, we show that once spatial clustering is introduced, fitting standard SEIR-models to infection numbers from the first few days of the epidemic, predictions are overestimated by a factor of two. The result is a significant over-estimation of the impact of the epidemic, in particular the reproduction number $\mathcal{R}_0$ and thus also the number of infected, both the maximal number of simultaneously infected and the endemic steady state number of infected. Since the population is highly susceptible in the beginning of an epidemic, this also highlights the benefits of early lockdowns to reduce the effect of the super+connectors.


The developed ABM was further used by SSI to estimate the effect of contact tracing related to COVID-19 in Denmark, see \autoref{appendix:ssi-report}. It was further used to estimate spread of the ``alpha'' variant of COVID-19 (B.1.1.7) in Denmark, see \autoref{appendix:ssi-notat}. Based on data available January 2nd 2021, the model predicted that the ``alpha'' variant would be the dominant variant in Denmark February 10--20, 2021. It became the dominant variant in Week 7: February 15--21, 2021 \autocite{bagerRiskHospitalisationAssociated2021}.
